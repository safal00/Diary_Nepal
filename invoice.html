<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Invoice Generator</title>

<style>
body{
    font-family: Arial;
    margin: 40px;
}
.header{
    text-align:center;
}
table{
    width:100%;
    border-collapse: collapse;
    margin-top:20px;
}
th, td{
    border:1px solid #000;
    padding:8px;
    text-align:center;
}
input{
    width:100%;
    border:none;
    text-align:center;
}
.amount-box{
    font-weight:bold;
    background:#f3f3f3;
}
.total-section{
    margin-top:20px;
    width:300px;
    float:right;
    text-align:right;
}
.total-section div{
    margin:5px 0;
}
.total-highlight{
    font-size:20px;
    font-weight:bold;
    border:2px solid #000;
    padding:6px;
}
button{
    margin-top:20px;
    padding:10px 20px;
    font-size:16px;
}
</style>
</head>

<body>

<div class="header">
    <h2>INVOICE</h2>
</div>

<table id="invoiceTable">
<thead>
<tr>
<th>SN</th>
<th>Description</th>
<th>Qty</th>
<th>Rate</th>
<th>Amount</th>
</tr>
</thead>

<tbody>
<tr>
<td>1</td>
<td><input></td>
<td><input type="number" value="0" oninput="calc()"></td>
<td><input type="number" value="0" oninput="calc()"></td>
<td class="amount-box">0</td>
</tr>

<tr>
<td>2</td>
<td><input></td>
<td><input type="number" value="0" oninput="calc()"></td>
<td><input type="number" value="0" oninput="calc()"></td>
<td class="amount-box">0</td>
</tr>

<tr>
<td>3</td>
<td><input></td>
<td><input type="number" value="0" oninput="calc()"></td>
<td><input type="number" value="0" oninput="calc()"></td>
<td class="amount-box">0</td>
</tr>
</tbody>
</table>

<div class="total-section">
<div>Grand Total</div>
<div id="grandTotal" class="total-highlight">0</div>
<div id="inWords"></div>
</div>

<button onclick="window.print()">Print</button>

<script>
function calc(){
    let rows = document.querySelectorAll("#invoiceTable tbody tr");
    let grandTotal = 0;

    rows.forEach(row=>{
        let qty = row.cells[2].children[0].value;
        let rate = row.cells[3].children[0].value;

        let amount = qty * rate;
        amount = Math.round(amount);

        row.cells[4].innerText = amount;

        grandTotal += amount;
    });

    document.getElementById("grandTotal").innerText = grandTotal;
    document.getElementById("inWords").innerText = numberToWords(grandTotal) + " only";
}

// number to words
function numberToWords(num){
    const a = ["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
    const b = ["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];

    if(num == 0) return "Zero";

    if(num < 20) return a[num];

    if(num < 100) return b[Math.floor(num/10)] + " " + a[num%10];

    if(num < 1000) return a[Math.floor(num/100)] + " Hundred " + numberToWords(num%100);

    if(num < 100000) return numberToWords(Math.floor(num/1000)) + " Thousand " + numberToWords(num%1000);

    if(num < 10000000) return numberToWords(Math.floor(num/100000)) + " Lakh " + numberToWords(num%100000);

    return numberToWords(Math.floor(num/10000000)) + " Crore " + numberToWords(num%10000000);
}
</script>

</body>
</html>
