<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body { font-family: 'Inter', sans-serif; padding:20px; background:#e6f0ff; }

.challan {
  width:210mm;
  min-height:297mm;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
  box-shadow:0 0 15px rgba(0,0,0,0.1);
}

h1 { text-align:center; color:#004aad; letter-spacing:2px; }

input{
  border:none;
  outline:none;
  background:transparent;
  width:100%;
  text-transform:capitalize;
}

.header-row{display:flex;justify-content:space-between;margin-bottom:20px;}
.details{display:flex;justify-content:space-between;margin-bottom:20px;}
.details div{width:48%;}

table{width:100%;border-collapse:collapse;margin-bottom:10px;}
table,th,td{border:1px solid #004aad;}
th{background:#cce0ff;}
th,td{padding:6px;}

.grand-total{text-align:right;font-size:20px;font-weight:bold;color:#004aad;}

.no-print{text-align:center;margin-top:15px;}
.btn{padding:6px 12px;margin:5px;background:#004aad;color:white;border:none;border-radius:5px;cursor:pointer;}

@media print{
.no-print{display:none;}
th:last-child,td:last-child{display:none;}
}
</style>
</head>

<body>

<div class="challan" id="invoice">

<h1>INVOICE</h1>

<div class="header-row">
<div>Invoice No: <input></div>
<div>Date: <input></div>
</div>

<div class="details">
<div>
<b>Company</b><br>
<input placeholder="Company Name">
<input placeholder="Address / Phone">
</div>

<div>
<b>Buyer</b><br>
<input id="buyerName" list="buyers" placeholder="Buyer Name">
<datalist id="buyers"></datalist>
<input placeholder="Buyer Address">
<input placeholder="Buyer Phone">
</div>
</div>

<table id="tbl">
<thead>
<tr>
<th>S.No</th>
<th>Description</th>
<th>Qty</th>
<th>Rate</th>
<th>Amount</th>
<th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="grand-total">
Grand Total: <span id="total">0</span>
</div>

<br>
Prepared By:
<input id="preparedBy" placeholder="Prepared By">

</div>

<div class="no-print">
<button class="btn" onclick="addRow()">+ Add Item</button>
<button class="btn" onclick="window.print()">Print</button>
</div>

<script>
const tbody=document.querySelector("#tbl tbody");
const totalEl=document.getElementById("total");

function addRow(){
let r=document.createElement("tr");
r.innerHTML=`
<td></td>
<td><input></td>
<td><input type=number value=1></td>
<td><input type=number value=0></td>
<td><input readonly></td>
<td><button onclick="this.parentNode.parentNode.remove();calc()">Remove</button></td>`;
tbody.appendChild(r);
r.querySelectorAll("input").forEach(i=>i.oninput=calc);
calc();
}
addRow();

function calc(){
let t=0;
tbody.querySelectorAll("tr").forEach((r,i)=>{
r.cells[0].innerText=i+1;
let q=r.cells[2].firstChild.value||0;
let rate=r.cells[3].firstChild.value||0;
let a=q*rate;
r.cells[4].firstChild.value=a;
t+=a;
});
totalEl.innerText=t;
}

/* CUSTOMER HISTORY */
let buyers=JSON.parse(localStorage.getItem("buyers")||"[]");
let list=document.getElementById("buyers");
function load(){
list.innerHTML="";
buyers.forEach(b=>{
let o=document.createElement("option");
o.value=b;
list.appendChild(o);
});
}
load();

document.getElementById("buyerName").onchange=function(){
let n=this.value.trim();
if(n && !buyers.includes(n)){
buyers.push(n);
localStorage.setItem("buyers",JSON.stringify(buyers));
load();
}
};
</script>

</body>
</html>
