<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Invoice Table</title>

<style>
body{
  font-family: Arial;
  margin:20px;
}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  border:1px solid #000;
  padding:6px;
  text-align:center;
}

input{
  width:100%;
  border:none;
  text-align:center;
  outline:none;
}

.controls{
  text-align:right;
  margin-bottom:10px;
}

button{
  padding:6px 12px;
  margin-left:5px;
  border:none;
  background:#007BFF;
  color:white;
  cursor:pointer;
}

button:hover{
  background:#0056b3;
}

.total{
  text-align:right;
  font-size:18px;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="controls">
  <button onclick="addRow()">Add Row</button>
  <button onclick="removeRow()">Remove Row</button>
  <button onclick="window.print()">Print</button>
</div>

<table id="invoice">
<thead>
<tr>
  <th>SN</th>
  <th>Description</th>
  <th>Qty</th>
  <th>Size</th>
  <th>Sq.ft</th>
  <th>Rate</th>
  <th>Amount</th>
</tr>
</thead>

<tbody>
<tr>
<td class="sn">1</td>
<td><input></td>
<td><input type="number" oninput="calculate(this)"></td>
<td><input oninput="calculate(this)" placeholder="2x3 or 24x36"></td>
<td><input readonly></td>
<td><input type="number" oninput="calculate(this)"></td>
<td><input readonly></td>
</tr>
</tbody>
</table>

<div class="total">
<b>Total: <span id="grandTotal">0</span></b>
</div>

<script>

function updateSerialNumbers(){
  const rows=document.querySelectorAll("#invoice tbody tr");
  rows.forEach((row,i)=>{
    row.querySelector(".sn").innerText=i+1;
  });
}

function addRow(){
  const tbody=document.querySelector("#invoice tbody");
  const row=tbody.rows[0].cloneNode(true);

  row.querySelectorAll("input").forEach(input=>{
    input.value="";
  });

  tbody.appendChild(row);
  updateSerialNumbers();
}

function removeRow(){
  const tbody=document.querySelector("#invoice tbody");
  if(tbody.rows.length>1){
    tbody.deleteRow(-1);
    updateSerialNumbers();
    grandTotal();
  }
}

function calculate(el){

  const row=el.parentElement.parentElement;

  const qty=parseFloat(row.cells[2].children[0].value) || 0;
  const size=row.cells[3].children[0].value.toLowerCase().replace(/ /g,'');
  const rate=parseFloat(row.cells[5].children[0].value) || 0;

  let sqFt=0;

  if(size.includes('x')){
    const parts=size.split('x');
    let w=parseFloat(parts[0]);
    let h=parseFloat(parts[1]);

    if(w && h){

      // if size large â†’ inches
      if(w>12 || h>12){
        sqFt=(w*h)/144;
      }else{
        sqFt=w*h;
      }

      sqFt=sqFt*qty;
    }
  }

  row.cells[4].children[0].value = sqFt ? sqFt.toFixed(2) : "";
  row.cells[6].children[0].value = rate ? (sqFt*rate).toFixed(2) : "";

  grandTotal();
}

function grandTotal(){
  let total=0;
  document.querySelectorAll("#invoice tbody tr").forEach(row=>{
    const amt=parseFloat(row.cells[6].children[0].value) || 0;
    total+=amt;
  });
  document.getElementById("grandTotal").innerText=total.toFixed(2);
}

</script>

</body>
</html>
