<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Invoice</title>

<style>
body{
    font-family: Arial;
    margin:40px;
    color:#000;
}

.header{
    text-align:center;
}

.company{
    font-size:26px;
    font-weight:bold;
}

.details{
    margin-top:10px;
    display:flex;
    justify-content:space-between;
}

.details div{
    width:48%;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}

th,td{
    border:1px solid #000;
    padding:8px;
    text-align:center;
}

th{
    background:#eaf2ff;
}

input{
    width:100%;
    border:none;
    text-align:center;
    font-size:14px;
}

.size-input{
    height:30px;
    font-weight:bold;
}

.controls{
    position:fixed;
    top:20px;
    right:20px;
}

.controls button{
    display:block;
    margin-bottom:6px;
    padding:8px 14px;
    font-weight:bold;
    cursor:pointer;
}

.footer{
    margin-top:40px;
    display:flex;
    justify-content:space-between;
}

@media print{
  .controls{ display:none; }
}
</style>
</head>

<body>

<div class="controls">
<button onclick="addRow()">Add Row</button>
<button onclick="removeRow()">Remove Row</button>
<button onclick="window.print()">Print</button>
</div>

<div class="header">
<div class="company">Nepal Print Solution Pvt. Ltd.</div>
<div>Address: Kathmandu, Nepal</div>
<div>Phone: 98XXXXXXXX</div>
</div>

<div class="details">
<div>
<b>Bill To:</b><br>
<input placeholder="Customer Name"><br>
<input placeholder="Address">
</div>

<div style="text-align:right">
Invoice No: <input style="width:120px"><br><br>
Date: <input type="date">
</div>
</div>

<table id="tbl">
<thead>
<tr>
<th>SN</th>
<th>Description</th>
<th>Qty</th>
<th>Size (ft/in)</th>
<th>Sq.Ft</th>
<th>Rate</th>
<th>Amount</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<h3 style="text-align:right;margin-top:20px">
Total: Rs. <span id="total">0</span>
</h3>

<div class="footer">
<div>
Prepared By:<br>
<input placeholder="Name">
</div>

<div style="text-align:right">
Authorized Signature
</div>
</div>

<script>
const tbody = document.querySelector("#tbl tbody");

function addRow(){
    const row = tbody.insertRow();

    row.innerHTML = `
    <td class="sn"></td>
    <td><input></td>
    <td><input type="number" value="1" oninput="calculate()"></td>
    <td><input class="size-input" placeholder="2x3 or 24x36" oninput="calculate()"></td>
    <td class="sqft">0</td>
    <td><input type="number" oninput="calculate()"></td>
    <td class="amount">0</td>
    `;

    updateSerial();
}

function removeRow(){
    if(tbody.rows.length>0){
        tbody.deleteRow(-1);
        updateSerial();
        calculate();
    }
}

function updateSerial(){
    document.querySelectorAll(".sn").forEach((sn,i)=>{
        sn.innerText = i+1;
    });
}

function calculate(){
    let total = 0;

    document.querySelectorAll("#tbl tbody tr").forEach(row=>{
        const qty = parseFloat(row.cells[2].children[0].value) || 0;
        const sizeText = row.cells[3].children[0].value.toLowerCase();
        const rate = parseFloat(row.cells[5].children[0].value) || 0;

        let sqft = 0;

        if(sizeText.includes("x")){
            let parts = sizeText.split("x");

            let w = parseFloat(parts[0]);
            let h = parseFloat(parts[1]);

            if(w && h){

                // detect inches automatically
                if(w > 20 || h > 20){
                    sqft = (w*h)/144;
                }else{
                    sqft = w*h;
                }

                sqft = sqft * qty;
            }
        }

        row.querySelector(".sqft").innerText = sqft.toFixed(2);

        let amount = sqft * rate;
        row.querySelector(".amount").innerText = amount.toFixed(2);

        total += amount;
    });

    document.getElementById("total").innerText = total.toFixed(2);
}

addRow();
</script>

</body>
</html>
