<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Delivery Challan</title>
<style>
body{font-family:Arial,sans-serif;margin:30px;color:#000;}
.wrapper{max-width:1000px;margin:auto;}
.header{text-align:center;font-size:26px;font-weight:700;margin-bottom:20px;}
.top{display:flex;justify-content:space-between;margin-bottom:20px;}
.box{border:1px solid #000;padding:10px;width:48%;}
.line{display:flex;justify-content:space-between;margin:4px 0;}
.fill{border-bottom:1px solid #000;flex:1;margin-left:5px;text-transform:capitalize;}
table{width:100%;border-collapse:collapse;margin-top:15px;}
th,td{border:1px solid #000;padding:6px;text-align:center;}
input{width:100%;border:none;text-align:center;text-transform:capitalize;}
.amount{text-align:right;}
.total-row td{border:none;}
.words{margin-top:8px;font-style:italic;}
.footer{margin-top:20px;display:flex;justify-content:space-between;font-size:14px;}
.footer input{border:none;border-bottom:1px solid #000;background:transparent;width:200px;}
.add-remove{margin:10px 0;}
.add-remove button{padding:8px 12px;margin-right:5px;background:#1565c0;color:#fff;border:none;border-radius:5px;cursor:pointer;font-weight:600;}
.add-remove button:hover{background:#0d47a1;}
@media print{
  .add-remove,.no-print{display:none;}
}
</style>
</head>
<body>

<div class="wrapper">
<div class="header">DELIVERY CHALLAN</div>

<div class="top">
<div class="box">
<div class="line"><span>Company Name:</span><span class="fill" contenteditable></span></div>
<div class="line"><span>Company Address:</span><span class="fill" contenteditable></span></div>
<div class="line"><span>Company Phone:</span><span class="fill" contenteditable></span></div>
</div>

<div class="box">
<div class="line"><span>CH No:</span><span class="fill" contenteditable>CH_</span></div>
<div class="line"><span>Date:</span><span class="fill" contenteditable>_ _ / _ _ / _ _ _ _</span></div>
<div class="line"><span>Buyer Name:</span><span class="fill" contenteditable></span></div>
<div class="line"><span>Buyer Phone:</span><span class="fill" contenteditable></span></div>
<div class="line"><span>Buyer Address:</span><span class="fill" contenteditable></span></div>
<div class="line"><span>Terms:</span><span class="fill" contenteditable></span></div>
<div class="line"><span>Prepaid By:</span><span class="fill" contenteditable></span></div>
</div>
</div>

<div class="add-remove no-print">
<button onclick="addRow()">Add Row</button>
<button onclick="removeRow()">Remove Row</button>
</div>

<table id="itemTable">
<thead>
<tr>
<th>SN</th>
<th>Description</th>
<th>Qty</th>
<th>Sq.Ft</th>
<th>Rate</th>
<th>Amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><input></td>
<td><input type="number" oninput="calc()"></td>
<td><input type="number" oninput="calc()"></td>
<td><input type="number" oninput="calc()"></td>
<td class="amount">0</td>
</tr>
</tbody>
</table>

<table>
<tr class="total-row">
<td colspan="4"></td>
<td><strong>Total</strong></td>
<td class="amount" id="grandTotal">0</td>
</tr>
</table>
<div class="words">
Amount in words: <span id="inWords">Zero Only</span>
</div>

<div class="footer">
<div>Received By: <input></div>
<div>Prepared By: <input></div>
</div>

<div class="no-print" style="margin-top:15px;text-align:center;">
<button onclick="printChallan()">Print</button>
<button onclick="saveAsImage()">Save as Image</button>
</div>
</div>

<script>
function calc(){
  let rows=document.querySelectorAll("#itemTable tbody tr");
  let grand=0;
  rows.forEach((row,i)=>{
    row.cells[0].innerText=i+1;
    let qty=parseFloat(row.cells[2].children[0].value)||0;
    let sqft=parseFloat(row.cells[3].children[0].value)||0;
    let rate=parseFloat(row.cells[4].children[0].value)||0;
    let amt=qty*sqft*rate;
    row.cells[5].innerText=amt.toFixed(2);
    grand+=amt;
  });
  document.getElementById("grandTotal").innerText=grand.toFixed(2);
  document.getElementById("inWords").innerText=numberToWords(grand);
}

function addRow(){
  let table=document.querySelector("#itemTable tbody");
  let row=table.rows[0].cloneNode(true);
  row.querySelectorAll("input").forEach(i=>i.value="");
  row.cells[5].innerText="0";
  table.appendChild(row);
}

function removeRow(){
  let table=document.querySelector("#itemTable tbody");
  if(table.rows.length>1)table.deleteRow(-1);
  calc();
}

function numberToWords(num){
  if(num==0)return "Zero Only";
  const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
  "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
  const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
  function inWords(n){
    if(n<20)return a[n];
    if(n<100)return b[Math.floor(n/10)]+" "+a[n%10];
    if(n<1000)return a[Math.floor(n/100)]+" Hundred "+inWords(n%100);
    if(n<100000)return inWords(Math.floor(n/1000))+" Thousand "+inWords(n%1000);
    return "";
  }
  return inWords(Math.floor(num))+" Only";
}

function printChallan(){window.print();}
function saveAsImage(){
  html2canvas(document.body,{scale:2}).then(canvas=>{
    let link=document.createElement("a");
    link.download="DeliveryChallan.png";
    link.href=canvas.toDataURL("image/png");
    link.click();
  });
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
