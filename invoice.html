<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Invoice - Diary Nepal</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f6f9;
}

header{
  background:#004aad;
  color:white;
  padding:15px;
}

.header-inner{
  max-width:1100px;
  margin:auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.header-inner button{
  background:white;
  color:#004aad;
  border:none;
  padding:8px 15px;
  border-radius:5px;
  font-weight:bold;
  cursor:pointer;
}

.container{
  max-width:1100px;
  margin:20px auto;
  background:white;
  padding:30px;
}

input, select{
  padding:6px;
  border:1px solid #ccc;
  border-radius:4px;
  margin:4px 0;
  width:100%;
}

button.action{
  background:#004aad;
  color:white;
  border:none;
  padding:8px 15px;
  border-radius:4px;
  cursor:pointer;
  font-weight:bold;
  margin-top:10px;
}

.invoice-title{
  text-align:center;
  font-size:26px;
  font-weight:bold;
  margin:20px 0;
  letter-spacing:1px;
}

.top-flex{
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:20px;
}

.logo img{
  max-height:100px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
}

th, td{
  border:1px solid #ccc;
  padding:10px;
  text-align:center;
}

th{
  background:#004aad;
  color:white;
}

tr:nth-child(even){
  background:#f2f2f2;
}

.total-section{
  width:350px;
  margin-left:auto;
  margin-top:20px;
}

.total-section div{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}

.signature{
  margin-top:70px;
  text-align:right;
}

.print-only{
  display:none;
}

.no-print{
  margin-top:15px;
}

/* PRINT STYLING */
@media print{

  body{
    background:white;
    font-size:14px;
  }

  header, .no-print{
    display:none !important;
  }

  input, select{
    display:none !important;
  }

  th{
    background:white !important;
    color:black !important;
  }

  .print-only{
    display:block;
  }

  .print-header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    margin-bottom:20px;
  }

  .print-company{
    text-align:left;
  }

  .print-logo img{
    max-height:100px;
  }

  .invoice-title{
    margin-top:10px;
  }
}
</style>
</head>

<body>

<header>
  <div class="header-inner">
    <button onclick="location.href='index.html'">‚Üê Home</button>
    <h2>Invoice Generator</h2>
    <div></div>
  </div>
</header>

<div class="container">

<!-- EDITABLE SECTION -->
<div class="top-flex no-print">
  <div style="flex:1">
    <select id="invoiceType" onchange="updateTitle()">
      <option>INVOICE</option>
      <option>TAX INVOICE</option>
      <option>PROFORMA INVOICE</option>
      <option>DELIVERY CHALLAN</option>
    </select>

    <input type="text" id="companyName" placeholder="Company Name">
    <input type="text" id="companyAddress" placeholder="Company Address">
    <input type="text" id="companyContact" placeholder="Phone / Email / PAN">
  </div>

  <div class="logo">
    <input type="file" accept="image/*" onchange="loadLogo(event)">
    <img id="logoPreview">
  </div>
</div>

<div class="invoice-title" id="invoiceTitle">INVOICE</div>

<div class="no-print">
  <div style="display:flex; justify-content:space-between; gap:20px;">
    <div>
      Invoice No:<br>
      <input type="text" id="invoiceNo" placeholder="INV-001">
    </div>
    <div>
      Date:<br>
      <input type="date" id="invoiceDate">
    </div>
  </div>

  <div style="margin-top:10px;">
    <strong>Bill To:</strong><br>
    <input type="text" id="customerName" placeholder="Customer Name">
    <input type="text" id="customerAddress" placeholder="Customer Address">
    <input type="text" id="customerContact" placeholder="Customer Contact">
  </div>
</div>

<!-- PRINT HEADER -->
<div class="print-only">
  <div class="print-header">
    <div class="print-company">
      <h2 id="printCompanyName"></h2>
      <div id="printCompanyAddress"></div>
      <div id="printCompanyContact"></div>
    </div>
    <div class="print-logo">
      <img id="printLogo">
    </div>
  </div>

  <div style="display:flex; justify-content:space-between; margin-top:15px;">
    <div>
      <strong>Bill To:</strong><br>
      <span id="printCustomerName"></span><br>
      <span id="printCustomerAddress"></span><br>
      <span id="printCustomerContact"></span>
    </div>
    <div>
      <strong>Invoice No:</strong> <span id="printInvoiceNo"></span><br>
      <strong>Date:</strong> <span id="printDate"></span>
    </div>
  </div>
</div>

<table id="invoiceTable">
<thead>
<tr>
<th>SN</th>
<th>Description</th>
<th>Qty</th>
<th>Rate</th>
<th>Total</th>
<th class="no-print">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><input type="text"></td>
<td><input type="number" value="0" oninput="calculate(this)"></td>
<td><input type="number" value="0" oninput="calculate(this)"></td>
<td class="rowTotal">0.00</td>
<td class="no-print"><button onclick="deleteRow(this)">X</button></td>
</tr>
</tbody>
</table>

<div class="no-print">
<button class="action" onclick="addRow()">+ Add Item</button>
<button class="action" onclick="window.print()">Print / Save PDF</button>
</div>

<div class="total-section">
<div><span>Subtotal:</span><span id="subtotal">0.00</span></div>
<div><span>Discount:</span><span><input type="number" id="discount" value="0" oninput="updateTotals()"></span></div>
<div><span>VAT %:</span><span><input type="number" id="vat" value="13" oninput="updateTotals()"></span></div>
<div><strong>Grand Total:</strong><strong id="grandTotal">0.00</strong></div>
</div>

<div style="margin-top:15px;">
<strong>Amount in Words:</strong><br>
<span id="amountWords"></span>
</div>

<div class="signature">
Authorized Signature
</div>

</div>

<script>
function updateTitle(){
  document.getElementById("invoiceTitle").innerText =
  document.getElementById("invoiceType").value;
}

function calculate(el){
  let row = el.parentElement.parentElement;
  let qty = parseFloat(row.children[2].children[0].value)||0;
  let rate = parseFloat(row.children[3].children[0].value)||0;
  let total = qty*rate;
  row.querySelector(".rowTotal").innerText = total.toFixed(2);
  updateTotals();
}

function updateTotals(){
  let totals=document.querySelectorAll(".rowTotal");
  let subtotal=0;
  totals.forEach(t=>subtotal+=parseFloat(t.innerText)||0);
  document.getElementById("subtotal").innerText=subtotal.toFixed(2);

  let discount=parseFloat(document.getElementById("discount").value)||0;
  let vat=parseFloat(document.getElementById("vat").value)||0;

  let afterDiscount=subtotal-discount;
  let vatAmount=(afterDiscount*vat)/100;
  let grand=afterDiscount+vatAmount;

  document.getElementById("grandTotal").innerText=grand.toFixed(2);
  document.getElementById("amountWords").innerText=numberToWords(Math.round(grand))+" only";
}

function addRow(){
  let table=document.getElementById("invoiceTable").getElementsByTagName('tbody')[0];
  let rowCount=table.rows.length+1;
  let row=table.insertRow();
  row.innerHTML=`
  <td>${rowCount}</td>
  <td><input type="text"></td>
  <td><input type="number" value="0" oninput="calculate(this)"></td>
  <td><input type="number" value="0" oninput="calculate(this)"></td>
  <td class="rowTotal">0.00</td>
  <td class="no-print"><button onclick="deleteRow(this)">X</button></td>
  `;
}

function deleteRow(btn){
  btn.parentElement.parentElement.remove();
  updateTotals();
}

function loadLogo(event){
  const reader=new FileReader();
  reader.onload=function(){
    document.getElementById("logoPreview").src=reader.result;
    document.getElementById("printLogo").src=reader.result;
  }
  reader.readAsDataURL(event.target.files[0]);
}

window.onbeforeprint=function(){
  document.getElementById("printCompanyName").innerText=
  document.getElementById("companyName").value;

  document.getElementById("printCompanyAddress").innerText=
  document.getElementById("companyAddress").value;

  document.getElementById("printCompanyContact").innerText=
  document.getElementById("companyContact").value;

  document.getElementById("printCustomerName").innerText=
  document.getElementById("customerName").value;

  document.getElementById("printCustomerAddress").innerText=
  document.getElementById("customerAddress").value;

  document.getElementById("printCustomerContact").innerText=
  document.getElementById("customerContact").value;

  document.getElementById("printInvoiceNo").innerText=
  document.getElementById("invoiceNo").value;

  document.getElementById("printDate").innerText=
  document.getElementById("invoiceDate").value;
};

function numberToWords(num){
  const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
  "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
  const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
  if(num<20) return a[num];
  if(num<100) return b[Math.floor(num/10)]+" "+a[num%10];
  if(num<1000) return a[Math.floor(num/100)]+" Hundred "+numberToWords(num%100);
  if(num<1000000) return numberToWords(Math.floor(num/1000))+" Thousand "+numberToWords(num%1000);
  return num;
}
</script>

</body>
</html>
