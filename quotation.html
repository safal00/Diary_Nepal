<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Premium Quotation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#eef2f9;margin:0;padding:20px}

.container{max-width:1100px;margin:auto;background:#ffffff;padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,.08)}
.header{display:flex;align-items:center;justify-content:center;margin-bottom:12px;padding:10px 0;border-bottom:1px solid #e6eaf2}
.logo-box{width:140px;height:140px;border:none;border-radius:12px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;background:transparent;cursor:pointer}
.logo-box.hasLogo #logoText{display:none}
.logo-box input{position:absolute;width:100%;height:100%;opacity:0;cursor:pointer}
.logo-box img{max-width:100%;max-height:100%;object-fit:contain;display:none}
.quote-badge{font-size:26px;font-weight:700;color:#2d4da5;letter-spacing:.5px}
button{padding:7px 16px;border:none;border-radius:6px;background:#2d4da5;color:#fff;margin:6px;cursor:pointer}
button:hover{background:#1f3674}
.table{width:100%;border-collapse:collapse;margin-top:10px}
.table th{background:#2d4da5;color:#fff;padding:10px}
.table td{border:1px solid #ddd;padding:10px;vertical-align:top}
textarea{width:100%;height:90px;border-radius:6px;padding:6px}
.design-box{width:190px;height:150px;border-radius:18px;background:#fff;border:1px solid #e3e6ef;box-shadow:0 4px 12px rgba(0,0,0,.08);overflow:hidden;position:relative;display:flex;align-items:center;justify-content:center;margin:auto}
.cap{ text-transform: capitalize; }
.design-box::after{content:"Upload Image";position:absolute;color:#9aa3b2;font-size:12px}
.design-box.hasImg::after{display:none}
.design-box input{position:absolute;width:100%;height:100%;opacity:0;cursor:pointer;z-index:3}
.design-box img{width:100%;height:100%;object-fit:contain;border-radius:14px;display:none}
.removeBtn{position:absolute;top:6px;right:6px;background:#ff4d4d;color:#fff;border-radius:50%;width:22px;height:22px;font-size:13px;display:none;align-items:center;justify-content:center;cursor:pointer}
.design-box.hasImg:hover .removeBtn{display:flex}
.footer{margin-top:20px;font-size:13px;color:#555}
@media print{
  #logoText{display:none !important;}
  .logo-box input{display:none !important;}
  .design-box::after{display:none !important;}
}
</style>
</head>
<body>

<div class="container">

<div class="header">
<div contenteditable="true" class="quote-badge">QUOTATION</div>
</div>

<div style="display:flex;justify-content:space-between;margin-bottom:10px">
<div>
<b>Company Details</b><br>
Company Name: <span contenteditable="true" class="cap" spellcheck="false"></span><br>
Address: <span contenteditable="true" class="cap" spellcheck="false"></span><br>
Phone: <span contenteditable="true" spellcheck="false"></span>
</div>
<div>
<b>Buyer Details</b><br>
Buyer Name: <span contenteditable="true" class="cap" spellcheck="false"></span><br>
Address: <span contenteditable="true" class="cap" spellcheck="false"></span><br>
Phone: <span contenteditable="true" spellcheck="false"></span>
</div>
<div>
Quotation No: <span contenteditable="true" spellcheck="false"></span><br>
Date: <span contenteditable="true" spellcheck="false"></span>
</div>
</div>

<button id="addBtn">Add Item</button>
<button id="undoBtn">Undo Delete</button>
<button onclick="window.print()">Print</button>

<table class="table" id="qTable">
<tr><th>S.No</th><th>Description</th><th>Design</th><th>Size</th><th>Qty</th><th>Rate</th><th>Amount</th><th>Action</th></tr>
</table>

<div class="footer">
Prepared By: <span contenteditable="true" class="cap" spellcheck="false" style="border-bottom:1px solid #aaa;min-width:120px;display:inline-block"></span>

<br><br>

<div style="display:flex;flex-direction:column;align-items:flex-start;gap:10px;margin:10px 0">
<label class="logo-box">
<span id="logoText" style="font-size:12px;color:#777">Click to Upload</span>
<input id="logoUpload" type="file" accept="image/*" onchange="previewLogo(this)">
<img id="logoImg">
</label>
<b>Company Stamp</b>
</div>

<br>
<b>Terms & Conditions</b><br>
1. Goods once sold not returnable.<br>
2. 50% advance required.<br>
3. Delivery within 7 days.
</div>

</div>

<script>
let count=0,lastDeleted=null;
const qTable=document.getElementById('qTable');

document.getElementById('addBtn').onclick=addRow;
document.getElementById('undoBtn').onclick=undoDelete;

function renumber(){
let rows=qTable.querySelectorAll('tr');
rows.forEach((r,i)=>{ if(i>0) r.cells[0].innerText=i;});
}

function addRow(){
count++;
let t=qTable.insertRow();
t.innerHTML=`
<td>${count}</td>
<td><div contenteditable='true' spellcheck='false' style='min-height:60px;max-height:60px;overflow:auto;padding:4px;word-break:break-word;'></div></td>
<td>
<div class='design-box'>
<input type='file' accept='image/*' onchange='preview(this)'>
<img>
<div class='removeBtn' onclick='removeImg(this,event)'>Ã—</div>
</div>
</td>
<td></td>
<td></td>
<td></td>
<td class='amt'></td>
<td><button onclick='deleteRow(this)'>Delete</button></td>`;
}

function deleteRow(btn){
lastDeleted=btn.closest('tr').outerHTML;
btn.closest('tr').remove();
renumber();
}

function undoDelete(){
if(lastDeleted){qTable.insertAdjacentHTML('beforeend',lastDeleted);lastDeleted=null;renumber();}
}

function preview(input){
let file=input.files[0];
if(!file) return;
let box=input.parentElement;
let img=box.querySelector('img');
let reader=new FileReader();
reader.onload=e=>{img.src=e.target.result;img.style.display='block';box.classList.add('hasImg');};
reader.readAsDataURL(file);
}

function removeImg(btn,e){
e.stopPropagation();
let box=btn.parentElement;
box.querySelector('img').style.display='none';
box.querySelector('input').value='';
box.classList.remove('hasImg');
}

function previewLogo(input){
 let file=input.files[0];
 if(!file) return;
 let img=document.getElementById('logoImg');
 let box=input.parentElement;
 let text=document.getElementById('logoText');
 let reader=new FileReader();
 reader.onload=function(e){
   img.src=e.target.result;
   img.style.display='block';
   if(text) text.style.display='none';
   box.classList.add('hasLogo');
 };
 reader.readAsDataURL(file);
}

window.onload=()=>{addRow();setupCapitalize();runTests();};

function capitalizeWords(text){
 if(!text) return text;
 return text
  .toLowerCase()
  .split(' ')
  .map(word=>word.charAt(0).toUpperCase()+word.slice(1))
  .join(' ');
}

function setupCapitalize(){
 document.querySelectorAll('.cap').forEach(el=>{
  el.addEventListener('blur',()=>{
    el.innerText=capitalizeWords(el.innerText.trim());
  });
 });
}

function runTests(){
 console.assert(capitalizeWords('pawan neupane')==='Pawan Neupane','Test1 failed');
 console.assert(capitalizeWords('PAWAN NEUPANE')==='Pawan Neupane','Test2 failed');
 console.assert(capitalizeWords('nEpAl print')==='Nepal Print','Test3 failed');
 console.log('Capitalize tests passed');
}
</script>
</body>
</html>
