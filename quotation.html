<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Quotation</title>

<style>
body{
font-family:Arial;
padding:20px;
}

/* BUTTONS */
button{cursor:pointer}

.addBtn{
background:#2a5fa5;
color:white;
border:none;
padding:6px 12px;
margin-bottom:10px;
}

.undoBtn{
background:green;
color:white;
border:none;
padding:6px 12px;
margin-left:10px;
}

.delBtn{
background:red;
color:white;
border:none;
padding:5px 10px;
}

/* TABLE */
table{
width:100%;
border-collapse:collapse;
margin-top:10px;
}

th,td{
border:1px solid #333;
padding:8px;
text-align:center;
}

th{
background:#2a5fa5;
color:white;
}

/* PREMIUM DESIGN COLUMN */
.designCell{
position:relative;
height:180px;
overflow:hidden;
border-radius:12px;
box-shadow:0 4px 12px rgba(0,0,0,0.15);
background:#f5f7ff;
}

.fileInput{display:none;}

.designImg{
width:100%;
height:100%;
object-fit:cover;
display:none;
transition:transform 0.4s ease;
}

.designCell:hover .designImg{
transform:scale(1.08);
}

.fileBtn{
padding:5px 10px;
}

.removeBtn{
position:absolute;
top:6px;
right:6px;
background:red;
color:white;
border:none;
display:none;
}

.designCell:hover .removeBtn.show{
display:block;
}

/* TERMS SECTION */
.terms{
margin-top:40px;
padding:15px;
border:1px solid #ccc;
border-radius:8px;
background:#fafafa;
}

.terms h3{
margin-bottom:10px;
}

/* MOBILE */
@media(max-width:768px){
.designCell{height:120px;}
}

@media(max-width:480px){
.designCell{height:100px;}
}

/* PRINT CLEAN */
@media print{
.addBtn,.undoBtn,.delBtn,.removeBtn,.fileBtn{
display:none !important;
}
}
</style>
</head>

<body>

<h2>QUOTATION</h2>

<button class="addBtn" onclick="addRow()">Add Item</button>
<button class="undoBtn" onclick="undoDelete()">Undo Delete</button>

<table>
<thead>
<tr>
<th>S.No</th>
<th>Description</th>
<th>Design</th>
<th>Size</th>
<th>Qty</th>
<th>Rate</th>
<th>Amount</th>
<th>Action</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<!-- TERMS & CONDITIONS -->
<div class="terms">
<h3>Terms & Conditions</h3>
<ol>
<li>Quotation valid for 7 days from issue date.</li>
<li>50% advance payment required before work start.</li>
<li>Final payment must be cleared before delivery.</li>
<li>Delivery time depends on order quantity.</li>
<li>Design once approved cannot be changed.</li>
<li>Transportation cost not included unless mentioned.</li>
<li>Company is not responsible for damage after delivery.</li>
</ol>
</div>

<script>

let tbody=document.getElementById("tbody");
let lastDeletedRow=null;
let lastDeletedIndex=null;

addRow();

function addRow(){
let n=tbody.rows.length+1;

let row=tbody.insertRow();

row.innerHTML=`
<td>${n}</td>
<td contenteditable></td>

<td class="designCell">
<input type="file" class="fileInput"
accept="image/*"
onchange="uploadPhoto(event,this)">

<button class="fileBtn"
onclick="this.previousElementSibling.click()">
Choose Photo
</button>

<img class="designImg">

<button class="removeBtn"
onclick="removePhoto(this)">âœ–</button>
</td>

<td contenteditable></td>
<td contenteditable></td>
<td contenteditable></td>
<td>0</td>

<td>
<button class="delBtn"
onclick="deleteRow(this)">Delete</button>
</td>
`;
}

function uploadPhoto(e,input){
let file=e.target.files[0];
if(!file) return;

let reader=new FileReader();

reader.onload=function(ev){
let cell=input.parentElement;
let img=cell.querySelector(".designImg");
let remove=cell.querySelector(".removeBtn");
let btn=cell.querySelector(".fileBtn");

img.src=ev.target.result;
img.style.display="block";
btn.style.display="none";
remove.classList.add("show");
};

reader.readAsDataURL(file);
input.value="";
}

function removePhoto(btn){
let cell=btn.parentElement;
let img=cell.querySelector(".designImg");
let fileBtn=cell.querySelector(".fileBtn");

img.src="";
img.style.display="none";
btn.classList.remove("show");
fileBtn.style.display="inline-block";
}

function deleteRow(btn){
if(!confirm("Delete this row?")) return;

let row=btn.closest("tr");
lastDeletedIndex=[...tbody.rows].indexOf(row);
lastDeletedRow=row.cloneNode(true);

row.remove();
updateSerial();

if(tbody.rows.length==0) addRow();
}

function undoDelete(){
if(!lastDeletedRow){
alert("Nothing to undo!");
return;
}

if(lastDeletedIndex>=tbody.rows.length)
tbody.appendChild(lastDeletedRow);
else
tbody.insertBefore(lastDeletedRow,tbody.rows[lastDeletedIndex]);

updateSerial();
lastDeletedRow=null;
}

function updateSerial(){
[...tbody.rows].forEach((r,i)=>{
r.cells[0].innerText=i+1;
});
}

</script>

</body>
</html>
