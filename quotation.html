<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Quotation - Final Ultimate</title>
<style>
  body { font-family: Arial, sans-serif; margin: 30px; color:#000;}
  h1 { color:#004aad; text-align:center; }
  .header, .footer { width:100%; margin-bottom:20px; }
  .flex { display:flex; justify-content:space-between; }
  .details { width:48%; }
  table { width:100%; border-collapse: collapse; margin-top:15px; }
  table th, table td { padding:8px 5px; text-align:left; }
  table th { background-color:#004aad; color:white; }
  table td { border-bottom:1px solid #ccc; }
  .photo-container { position:relative; width:120px; height:80px; }
  .photo-container img.preview { width:100%; height:100%; object-fit:contain; display:none; }
  .remove-btn { position:absolute; top:2px; right:2px; background:red; color:white; border:none; cursor:pointer; display:none; padding:2px 5px; }
  .btn { padding:5px 10px; margin-top:5px; cursor:pointer; }
  .totals { width:50%; margin-top:15px; float:right; }
  .totals div { display:flex; justify-content:space-between; margin-bottom:5px; }
  .underline { border-bottom:1px solid #000; margin-top:5px; margin-bottom:5px; }
  .signature-section { margin-top:50px; display:flex; justify-content:space-between; }
  .sig-box { width:48%; text-align:center; }
  .stamp-box { width:150px; height:80px; border:1px solid #000; margin-top:10px; display:inline-block; text-align:center; vertical-align:middle; line-height:80px; }
</style>
</head>
<body>

<h1>QUOTATION</h1>

<div class="flex header">
  <div class="details">
    <strong>Client Details:</strong><br>
    Name: <input type="text" placeholder="Client Name"><br>
    Company: <input type="text" placeholder="Client Company"><br>
    Phone: <input type="text" placeholder="Client Phone">
  </div>
  <div class="details">
    <strong>Company Details:</strong><br>
    Name: <input type="text" placeholder="Company Name"><br>
    Address: <input type="text" placeholder="Company Address">
  </div>
</div>

<table id="itemTable">
  <thead>
    <tr>
      <th>S/N</th>
      <th>Description</th>
      <th>Photo</th>
      <th>Size</th>
      <th>Quantity</th>
      <th>Unit Price</th>
      <th>Amount</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<button class="btn" onclick="addRow()">+ Add Item</button>

<div class="totals">
  <div><span>Subtotal:</span><span id="subtotal">0</span></div>
  <div><span>Discount:</span><span><input type="number" value="0" id="discount" oninput="updateTotals()"></span></div>
  <div><strong>Grand Total:</strong><strong id="grandtotal">0</strong></div>
  <div><strong>In Words:</strong><strong id="grandwords"></strong></div>
</div>

<div class="underline"></div>

<div class="terms">
  <h3>Terms & Conditions:</h3>
  <ol>
    <li>Term one.</li>
    <li>Term two.</li>
    <li>Term three.</li>
    <li>Term four.</li>
    <li>Term five.</li>
  </ol>
</div>

<div class="signature-section">
  <div class="sig-box">
    Signature<br>
    Name / Position: <input type="text" placeholder="Manager">
  </div>
  <div class="sig-box">
    Company Stamp<br>
    <div class="stamp-box">STAMP</div>
  </div>
</div>

<script>
let itemCount = 0;

function addRow(){
  itemCount++;
  const tbody = document.getElementById('itemTable').querySelector('tbody');
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td class="sn">${itemCount}</td>
    <td><input type="text" placeholder="Description"></td>
    <td>
      <div class="photo-container">
        <img class="preview">
        <button class="remove-btn" onclick="removeImg(this)">Ã—</button>
        <input type="file" accept="image/*" onchange="previewImg(event,this)">
      </div>
    </td>
    <td><input type="text" placeholder="Size"></td>
    <td><input type="number" value="1" oninput="updateAmount(this)"></td>
    <td><input type="number" value="0" oninput="updateAmount(this)"></td>
    <td class="amount">0</td>
  `;
  tbody.appendChild(tr);
  updateTotals();
}

function previewImg(event,input){
  const file = input.files[0];
  const img = input.parentElement.querySelector('img.preview');
  const removeBtn = input.parentElement.querySelector('.remove-btn');

  if(file){
    img.src = URL.createObjectURL(file);
    img.style.display='block';
    input.style.display='none';
    img.parentElement.onmouseenter = ()=> removeBtn.style.display='block';
    img.parentElement.onmouseleave = ()=> removeBtn.style.display='none';
  } else {
    img.src='';
    img.style.display='none';
    removeBtn.style.display='none';
    input.style.display='inline-block';
  }
}

function removeImg(btn){
  const container = btn.parentElement.parentElement;
  container.remove();
  itemCount--;
  updateSerials();
  updateTotals();
}

function updateSerials(){
  const rows = document.querySelectorAll('#itemTable tbody tr');
  let sn=1;
  rows.forEach(r=>{
    r.querySelector('.sn').innerText=sn++;
  });
}

function updateAmount(input){
  const row = input.parentElement.parentElement;
  const qty = row.querySelector('td:nth-child(5) input').value;
  const price = row.querySelector('td:nth-child(6) input').value;
  const amountCell = row.querySelector('.amount');
  amountCell.innerText = qty * price;
  updateTotals();
}

function updateTotals(){
  let subtotal = 0;
  const amounts = document.querySelectorAll('.amount');
  amounts.forEach(a=>subtotal+=Number(a.innerText));
  const discount = Number(document.getElementById('discount').value) || 0;
  const grand = subtotal - discount;
  document.getElementById('subtotal').innerText=subtotal;
  document.getElementById('grandtotal').innerText=grand;
  document.getElementById('grandwords').innerText=numberToWords(grand);
}

// Simple number to words (English only)
function numberToWords(num){
  const a=['','One','Two','Three','Four','Five','Six','Seven','Eight','Nine','Ten',
  'Eleven','Twelve','Thirteen','Fourteen','Fifteen','Sixteen','Seventeen','Eighteen','Nineteen'];
  const b=['','','Twenty','Thirty','Forty','Fifty','Sixty','Seventy','Eighty','Ninety'];
  if(num==0) return 'Zero Only';
  let words='';
  if(num>=1000){
    words+=a[Math.floor(num/1000)]+' Thousand ';
    num%=1000;
  }
  if(num>=100){
    words+=a[Math.floor(num/100)]+' Hundred ';
    num%=100;
  }
  if(num>=20){
    words+=b[Math.floor(num/10)]+' ';
    num%=10;
  }
  if(num>0) words+=a[num]+' ';
  return words+'Only';
}
</script>

</body>
</html>
