<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Premium Quotation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:'Segoe UI',Arial;background:linear-gradient(120deg,#e8ecff,#f5f7ff);margin:0;padding:20px}
.container{max-width:1100px;margin:auto;background:#fff;padding:25px;border-radius:14px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
h1{text-align:center;margin-bottom:20px}

/* TABLE */
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#2f3ee6;color:#fff}
input,textarea{width:100%;padding:6px;border:1px solid #ccc;border-radius:6px}
button{background:#2f3ee6;color:#fff;border:none;padding:8px 15px;border-radius:6px;margin:6px;cursor:pointer}
button:hover{background:#1e2bb8}
.section{margin-top:25px}
.flex{display:flex;gap:20px;margin-top:20px}
.box{flex:1;border:1px solid #ddd;padding:15px;border-radius:10px}

.logo-preview{max-height:90px;display:none;margin:10px auto}
.design-preview{width:100%;height:90px;object-fit:contain;display:none}
.design-wrap{position:relative}
.remove-btn{position:absolute;top:2px;right:2px;background:red;border:none;color:#fff;border-radius:50%;width:18px;height:18px;font-size:11px;display:none;cursor:pointer}
.design-wrap:hover .remove-btn{display:block}

.total{font-weight:bold;text-align:right;margin-top:15px;font-size:18px}
</style>
</head>

<body>
<div class="container" id="quotationBox">
<h1>QUOTATION</h1>

<div class="flex">
<div class="box">
<b>Company Details</b><br>
<input placeholder="Company Name"><br><br>
<input placeholder="Address"><br><br>
<input placeholder="Phone"><br><br>
<input type="file" onchange="showLogo(this,'logo1')"><br>
<img id="logo1" class="logo-preview">
</div>

<div class="box">
<b>Client Details</b><br>
<input placeholder="Client Name"><br><br>
<input placeholder="Address"><br><br>
<input placeholder="Phone"><br>
</div>
</div>

<table id="items">
<tr>
<th>SN</th>
<th>Description</th>
<th>Design</th>
<th>Size</th>
<th>Qty</th>
<th>Rate</th>
<th>Amount</th>
<th>Delete</th>
</tr>
</table>

<button onclick="addItem()">Add Item</button>
<button onclick="downloadPDF()">Download PDF</button>
<button onclick="shareQuotation()">Share</button>

<div class="total" id="grandTotal" style="display:none">Grand Total: 0.00</div>

<div class="section">
<b>Terms & Conditions</b>
<textarea rows="5">1. Payment after delivery
2. Design once approved cannot change
3. Delivery within 7 days
4. Transportation extra
5. Thank you</textarea>
</div>

<div class="flex">
<div class="box" style="text-align:center">
<b>Prepared By</b><br><br>
<img id="logo2" class="logo-preview"><br>
<input placeholder="Name"><br>
<input type="file" onchange="showLogo(this,'logo2')"><br>
</div>

<div class="box" style="text-align:center">
<b>Approved By</b><br><br>
<img id="logo3" class="logo-preview"><br>
<input placeholder="Name"><br>
<input type="file" onchange="showLogo(this,'logo3')"><br>
</div>
</div>
</div>

<script>
function addItem(){
let table=document.getElementById('items');
let row=table.insertRow();
let sn=table.rows.length-1;
row.innerHTML=`
<td>${sn}</td>
<td><input></td>
<td>
<div class='design-wrap'>
<input type='file' onchange='showDesign(this)'>
<img class='design-preview'>
<button class='remove-btn' onclick='removeDesign(this,event)'>x</button>
</div>
</td>
<td><input></td>
<td><input type='number' oninput='calc(this)'></td>
<td><input type='number' oninput='calc(this)'></td>
<td>0.00</td>
<td><button onclick='delRow(this)'>X</button></td>`;
}

function showDesign(inp){
if(inp.files[0]){
let img=inp.parentNode.querySelector('img');
img.src=URL.createObjectURL(inp.files[0]);
img.style.display='block';
inp.style.display='none';
}
}

function removeDesign(btn,e){
e.stopPropagation();
let wrap=btn.parentNode;
wrap.querySelector('img').style.display='none';
wrap.querySelector('input').value='';
wrap.querySelector('input').style.display='block';
}

function calc(el){
let r=el.parentNode.parentNode;
let qty=r.cells[4].children[0].value||0;
let rate=r.cells[5].children[0].value||0;
r.cells[6].innerHTML=(qty*rate).toFixed(2);
updateTotal();
}

function updateTotal(){
let sum=0;
document.querySelectorAll('#items tr').forEach((r,i)=>{
if(i>0) sum+=parseFloat(r.cells[6].innerHTML)||0;
});
if(sum>0){
document.getElementById('grandTotal').style.display='block';
document.getElementById('grandTotal').innerHTML='Grand Total: '+sum.toFixed(2);
}
}

function delRow(btn){
btn.closest('tr').remove();
renumber();
updateTotal();
}

function renumber(){
let rows=document.querySelectorAll('#items tr');
for(let i=1;i<rows.length;i++) rows[i].cells[0].innerHTML=i;
}

function showLogo(inp,id){
if(inp.files[0]){
let img=document.getElementById(id);
img.src=URL.createObjectURL(inp.files[0]);
img.style.display='block';
}
}

function downloadPDF(){
html2canvas(document.getElementById('quotationBox'),{scale:2}).then(canvas=>{
const img=canvas.toDataURL('image/png');
const pdf=new jspdf.jsPDF('p','mm','a4');
let w=210; let h=canvas.height*w/canvas.width;
pdf.addImage(img,'PNG',0,0,w,h);
pdf.save('quotation.pdf');
});
}

function shareQuotation(){
html2canvas(document.getElementById('quotationBox'),{scale:2}).then(canvas=>{
canvas.toBlob(async blob=>{
let file=new File([blob],'quotation.png',{type:'image/png'});
if(navigator.canShare && navigator.canShare({files:[file]})){
await navigator.share({files:[file],title:'Quotation'});
}else{
let a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download='quotation.png';
a.click();
}
});
});
}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</body>
</html>
